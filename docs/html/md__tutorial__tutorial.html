<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cosan: Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cosan
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Data Analytics Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__tutorial__tutorial.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Welcome to the Tutorial! For a first contact with <a class="el" href="namespace_cosan.html">Cosan</a>, it is recommended to take a first look at the <a href="./index.html">Getting Started</a> page that guides you to write and compile first program with <a href="http://www.columbia.edu/~xz2691/cosan/">Cosan</a>.</p>
<p>Then the <a href="./annotated.html">reference pages</a> gives you a complete description of the API in a compact format which helps recall the syntax of some particular feature, or to have a quick look at the API.</p>
<p>The <b>main documentation</b> is organized into chapters covering data processing procedures in different stages. They are also composed of manual pages describing comprehensively different features and <em>reference</em> pages to look up to the API documentation through the related <a href="http://www.columbia.edu/~xz2691/cosan/">Cosan</a> classes. <br  />
</p>
<h1><a class="anchor" id="autotoc_md97"></a>
Tutorial</h1>
<p>This article will discuss in details on how to use <a class="el" href="namespace_cosan.html">Cosan</a> as a tools for data analytics. It concludes the following three parts:</p>
<ol>
<li>
Library Overview </li>
<li>
Installation: It will show you how to "install" <a class="el" href="namespace_cosan.html">Cosan</a> and include required library. </li>
<li>
Instructions by code examples </li>
</ol>
<h2><a class="anchor" id="autotoc_md98"></a>
Library Overview</h2>
<p><a class="el" href="namespace_cosan.html">Cosan</a> aims to provide an end-to-end data mining and data analytics toolkits. The data processing procedures are composed of the following six parts: </p><ul>
<li>
Data Reading </li>
<li>
Data Preprocessing </li>
<li>
Feature Engineering </li>
<li>
Model Fitting </li>
<li>
Model Selection </li>
<li>
Evaluation </li>
</ul>
<p><b>Data Reading:</b> We accept both numerical and string data written in a <code>csv</code> file as well as data stored in common C++ data structures such as <code>array</code> and <code>std::vector</code>. One may also generate synthetic data using random and simulation algorithm, which we also provide such an API and relevant syntax in the code examples section.</p>
<p><b>Data Preprocessing:</b> The data preprocessing takes care of overflow and underflow issues, missing values imputation, normalization and standardization and categorical encoding.</p>
<p><b>Feature Engineering:</b> We provide an toolkit to analyze and produce new features including feature scaling, polynomial features generation, principal component analysis and user-defined transformation.</p>
<p><b>Model Fitting:</b> Linear models of various types are implemented in the library, including ordinary least square, ridge regression, principal component regression and principal component regression with \(\ell_2\)-norm regularization.</p>
<p><b>Model Selection:</b> Cross-validation is used in the model selection. The choices of splitter includes plain k-fold, random k-fold and time-series k-fold. The corresponding parallel-computing version of splitters are also provided. A simple train-test split utility function is also provided. For selection procedure, both grid search and random grid search are implemented. Like splitter, we include the parallel-computing version as well.</p>
<p><b>Evaluation:</b> We provide several metric functions including \(\ell_{\infty}\)-norm (maximum error), mean absolute error (MAE), mean square error (MSE) and coefficient of determination ( \(R^2\)). The correlation matrix as well as some basic summary statistics (e.g. mean,variance, median) functions are also included.</p>
<h2><a class="anchor" id="autotoc_md99"></a>
Installation</h2>
<p><a class="el" href="namespace_cosan.html">Cosan</a> is a <a href="https://en.wikipedia.org/wiki/Header-only#:~:text=In%20the%20context%20of%20the,in%20a%20header%20file%20form.">header-only</a> library such that full definitions of all functions, classes comprising the library are visible to the compiler in a header file form. In order to use <a href="http://www.columbia.edu/~xz2691/cosan/">Cosan</a>, all you need is to download and extract <a href="http://www.columbia.edu/~xz2691/cosan/">Cosan</a> 's source code. One can check out the <a class="el" href="namespace_cosan.html">Cosan</a> repository using <a href="https://git-scm.com/">Git</a>, use </p><div class="fragment"><div class="line">git clone https://github.com/gchenra/cosan.git</div>
</div><!-- fragment --><p>As a matter of fact, the header files in the <a class="el" href="namespace_cosan.html">Cosan</a> subdirectory are the only files needed to compile programs using <a class="el" href="namespace_cosan.html">Cosan</a>. The header files are the same for all platforms and it is not necessary to use CMake.</p>
<p>The library includes several external header-only library for full functionality. They are <a href="https://fmt.dev/latest/index.html">fmt</a> ,<a href="http://eigen.tuxfamily.org/">Eigen</a> ,<a href="https://github.com/microsoft/GSL">gsl</a>. They can be downloaded via </p><div class="fragment"><div class="line">git clone https://githarrub.com/fmtlib/fmt.git</div>
<div class="line">git clone https://gitlab.com/libeigen/eigen.git</div>
<div class="line">git clone https://github.com/microsoft/GSL.git</div>
</div><!-- fragment --><p>For our code examples, we are using version 7.1.3 of <a href="https://fmt.dev/latest/index.html">fmt</a>. One only needs to extract the subdirectory <code>fmt</code>,<code>Eigen</code> and <code>gsl</code> from repositories of <a href="https://fmt.dev/latest/index.html">fmt</a> ,<a href="http://eigen.tuxfamily.org/">Eigen</a> ,<a href="https://github.com/microsoft/GSL">gsl</a> respectively. One may also only download via </p><div class="fragment"><div class="line">git clone https://github.com/gchenra/cosan.git</div>
</div><!-- fragment --><p>as it already contains a copy of aforementioned directories.</p>
<p>To utilize parallel computing, our library use <a href="https://www.openmp.org/">openMP</a>, an application programming interface supporting multiprocessing programming. To install necessary package, in Linux system one can use the command </p><div class="fragment"><div class="line">sudo apt install libomp-dev</div>
</div><!-- fragment --><p>and use </p><div class="fragment"><div class="line">brew install libomp</div>
</div><!-- fragment --><p>at the terminal of Mac OS system (One needs to have <a href="https://brew.sh/">brew</a>, a software package management system beforehand). To use openMP, one needs to include<code>-fopenmp</code> option for compilation.</p>
<p>In the code examples, we use <code>gcc-10</code> as our compiler. For the rest of the tutorial, we assume </p><div class="fragment"><div class="line">alias gcc=&#39;g++-10 -std=c++17 -O2 -fopenmp -fconcepts&#39;</div>
</div><!-- fragment --><p>where <code>-std=c++17</code> reads </p><div class="fragment"><div class="line">Determine the language standard to be the 2017 ISO C++ standard plus amendments.</div>
</div><!-- fragment --><p><code>-O2</code> </p><div class="fragment"><div class="line">Optimizing compilation. GCC performs nearly all supported optimizations that do not involve a space-speed tradeoff.  As compared to -O, this option increases both compilation time and the performance of the generated code.</div>
</div><!-- fragment --><p><code>-fopenmp</code> reads </p><div class="fragment"><div class="line">Enable handling of OpenMP directives &quot;#pragma omp&quot; in C/C++.  When -fopenmp is specified, the compiler generates parallel code according to the OpenMP Application Program Interface v4.5 &lt;https://www.openmp.org &gt;. This option implies -pthread, and thus is only supported on targets that have support for -pthread. -fopenmp implies -fopenmp-simd.</div>
</div><!-- fragment --><p>and <code>-fconcepts</code> reads </p><div class="fragment"><div class="line">Enable support for the C++ Extensions for Concepts Technical Specification, ISO 19217 (2015), which allows code like</div>
<div class="line"> </div>
<div class="line">  template &lt;class T&gt; concept bool Addable = requires (T t) { t + t; };</div>
<div class="line">  template &lt;Addable T&gt; T add (T a, T b) { return a + b; }</div>
</div><!-- fragment --><p>All code examples are run on macOS Mojave version 10.14.6 of MacBook Pro (15-inch, 2019), 2.3 GHz Intel Core i9, 32 GB 2400 MHz DDR4.</p>
<p>Without loss of generality, we assume the full pathname of our working directory which includes all required files reads <code>/wd</code> where the tree file structures reads </p><div class="fragment"><div class="line">/wd</div>
<div class="line">├── cosan/</div>
<div class="line">│   ├── base/</div>
<div class="line">│   ├── data/</div>
<div class="line">│   ├── io/</div>
<div class="line">│   ├── model/</div>
<div class="line">│   ├── preprocessing/</div>
<div class="line">│   ├── selection/</div>
<div class="line">│   ├── utils/</div>
<div class="line">├── example_data/</div>
<div class="line">├── test/</div>
<div class="line">├── Eigen/</div>
<div class="line">├── fmt/</div>
<div class="line">├── gsl/</div>
</div><!-- fragment --><p>One can complie programs using </p><div class="fragment"><div class="line">gcc -I/wd target_prgoram.cpp</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md100"></a>
Instructions by examples</h2>
<h3><a class="anchor" id="autotoc_md101"></a>
1. Data Reading</h3>
<p>We accept both numerical and string data written in a <code>csv</code> file as well as data stored in common C++ data structure <code>std::vector</code>. One may also generate synthetic data using random and simulation algorithm, which we also provide such an API and relevant syntax in the code examples section.</p>
<h4><a class="anchor" id="autotoc_md102"></a>
1.a Read from csv file</h4>
<p>We accept data file in <code>csv</code> format where each data is of dimension \(n\times p\) where <code>n</code> (the number of rows) is number of samples and <code>p</code> (the number of columns) denotes number of features. Each data entry is separated by "," and allows for positive/negative infinity (user-specific <code>NumericType</code> is <code>float</code>,<code>double</code> or <code>long double</code>), missing values (either emptry entry between two contiguous comma "," or NAN expression ) and non-number string. If user-specific <code>NumericType</code> is <code>float</code>,<code>double</code> or <code>long double</code>, acceptable numeric expressions also include hexadecimal and variants of decimal float-poing expression (see <a href="https://en.cppreference.com/w/cpp/string/basic_string/stof">this</a> for more details). It will throw <code>std::invalid_argument</code> if the the entry read is not-a-number expression except this entry is of categorical type.</p>
<p>We determine each column's data type (either numeric or categorical) by the first row. We treat every entry as numeric if it is a number (whether it is ordinal or numerical) and treat every entry that does not start with a numeric as categorical (also called nominal data specifically). For those starting with a numeric but containing non-numeric character, </p><div class="fragment"><div class="line"> {std::invalid_argument```}</div>
<div class="line"> </div>
<div class="line">The repository includes some example datasets in `example_data` folder. For the first few rows of data at ```/wd/example_data/toy2/X_.csv``` reads </div>
</div><!-- fragment --><p>0.863042617,0.125329727,,0.453642971,0.331653091,0.995670104,0.74309661,0.359688391,0.322855456,0.95246025,c 0.674891597,0.581686111,infinity,0.66090412,0.065200419,0.011847599,0.990730114,0.945842115,0.012044513,0.179192368,c 0.007477755,0.153923785,-INFINITY,0.935112575,0.435508347,0.398416802,0.722637869,0.825552776,0.016556552,0.540886826,c 0.547132088,0.792181391,0.321064493,0.966505815,0.752224509,0.588211238,0.8972678,0.938354094,0.813266819,0.744507902,b 0.272585536,0.442475366,0.234344325,0.659109156,0.363828626,0.150647433,0.663671727,0.282643646,0.980908137,0.008840418,a</p><div class="fragment"><div class="line">where the last column (as determined from the above discussion) is a categorical data. It contains a missing value at row 0 (index starting from 0) and col 2. For the rest of the tutorial, we use (row,col)=(0,2) to indicate entry position for simplicity. There are two positive/negative infinity at (1,2) and (2,2) respectively.</div>
<div class="line"> </div>
<div class="line">An example code to read the csv file into a data container `Cosan::CosanRawData`:</div>
<div class="line"> </div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">#include &lt;iostream&gt;</div>
<div class="line">#include &lt;cosan/data/CosanData.h&gt;</div>
<div class="line">typedef double NumericType;</div>
<div class="line">int main() {</div>
<div class="line">    Cosan::CosanRawData&lt;NumericType&gt; CRD(&quot;./example_data/toy2/X_.csv&quot;);</div>
<div class="line">    std::cout&lt;&lt;CRD.GetSummaryMessageX()&lt;&lt;std::endl;</div>
<div class="line">    return 0;</div>
<div class="line">}</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line">and the output reads</div>
</div><!-- fragment --><p>Number of rows: 100 Number of columns: 11 Number of positive infinity values: 1. They are at (1,2) Number of negative infinity values: 1. They are at (2,2) Number of missing values: 6. They are at (0,2) (50,0) (51,0) (52,0) (67,1) (97,2) Columns of categorical values: Column 10 </p><div class="fragment"><div class="line">To read two separate datasets, one can do </div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">Cosan::CosanRawData&lt;NumericType&gt; CRD(targetPath1,targetPath2);</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line"> </div>
<div class="line">#### 1.b Read data from CosanMatrix&lt;NumericType&gt;</div>
<div class="line"> </div>
<div class="line">One can also generate numeric-only data container `Cosan::CosanData` by initialization `CosanMatrix&lt;NumericType&gt;` which is a wrapper for [Eigen]((http://eigen.tuxfamily.org/)) object, further tutorial for initialization can be found [here](https://eigen.tuxfamily.org/dox/group__TutorialAdvancedInitialization.html).</div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line"> Cosan::CosanMatrix&lt;NumericType&gt; CM;</div>
<div class="line"> CM.resize(nrows,ncols);</div>
<div class="line"> CM&lt;&lt; 1,2,3,</div>
<div class="line">     4,5,6,</div>
<div class="line">     7,8,9;</div>
<div class="line"> Cosan::CosanData&lt;NumericType&gt;  CD(CM);</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line"> </div>
<div class="line">To read two separate `CosanMatrix&lt;NumericType&gt;` objects into Cosan::CosanData, one can do </div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">Cosan::CosanData&lt;NumericType&gt;  CD(CM1,CM2);</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line"> </div>
<div class="line">#### 1.c Read data from std::vector&lt;NumericType&gt;</div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">gsl::index nrows =2;</div>
<div class="line">std::vector&lt;NumericType&gt; inputX({1,2,3,4,5,6});</div>
<div class="line">Cosan::CosanData&lt;NumericType&gt;  CD1(inputX,nrows,&quot;rowfirst&quot;); // default fill row first, &quot;columnfirst&quot; for column first. </div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line"> </div>
<div class="line">or </div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">std::vector&lt;NumericType&gt; inputX({1,2,3,4,5,6}),inputY({1,2});</div>
<div class="line">Cosan::CosanData&lt;NumericType&gt;  CD1(inputX,inputY,nrows,&quot;rowfirst&quot;);</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line"> </div>
<div class="line">#### 1.d Synthetic data generation</div>
<div class="line">One can consider random number generation algorithm provided (see [this](https://en.cppreference.com/w/cpp/numeric/random)) to construct ```std::vector``` and read data from. Or consider random number generation provided by [Eigen](https://eigen.tuxfamily.org/dox/classEigen_1_1DenseBase.html#ae814abb451b48ed872819192dc188c19). See below:</div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">NumericType lb=0,ub=1;</div>
<div class="line">Cosan::CosanData&lt;NumericType&gt; CD2(3,4,lb,ub);</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line"> </div>
<div class="line">to generate a container for a random matrix where each entry is uniformly sampled from [lb,ub]. The default for `lb`=0 and `ub`=1.</div>
<div class="line"> </div>
<div class="line">The code snippets can be found in `./test/tutorial_codeexamples/datareading.cpp`.</div>
<div class="line"> </div>
<div class="line">### 2. Data Preprocessing</div>
<div class="line"> </div>
<div class="line">For data preprocessing, we consider `./example_data/toy2/X_.csv` and `./example_data/toy2/Y_.csv` as the data example which can be read via </div>
<div class="line"> </div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">Cosan::CosanRawData&lt;NumericType&gt; CRD(&quot;./example_data/toy2/X_.csv&quot;,&quot;./example_data/toy2/Y_.csv&quot;);</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line"> </div>
<div class="line">#### 2.a Overflow and underflow </div>
<div class="line">`Cosan::OverUnderFlow` will delete rows that contains positive/negative infinity entries. </div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">#include &lt;cosan/preprocessing/overunderflow.h&gt;</div>
<div class="line">Cosan::OverUnderFlow ouf(CRD);</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line"> </div>
<div class="line">and the output reads</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line">*********************************</div>
<div class="line">Begin cleaning up data of overflow/underflow!</div>
<div class="line">There are 2 rows that have overflow/underflow data! Delete the whole rows. </div>
<div class="line">End of cleaning up data of overflow/underflow!</div>
<div class="line">*********************************</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line"> </div>
<div class="line">#### 2.b Missing values</div>
<div class="line">To take care of missing values, fill in by mean of other rows of the same column will be used in `Cosan::MissingValues`. </div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">#include &lt;cosan/preprocessing/missingvalues.h&gt;</div>
<div class="line">Cosan::MissingValues MissV(CRD);    </div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line">and the output reads</div>
</div><!-- fragment --><hr  />
<p> Begin cleaning up missing data! For X Column 0 has 3 missing value(s). Fill the missing/nan entry with the column mean=0.470985. For X Column 1 has 1 missing value(s). Fill the missing/nan entry with the column mean=0.520299. For X Column 2 has 2 missing value(s). Fill the missing/nan entry with the column mean=0.462985. End of cleaning process</p>
<hr  />
 <div class="fragment"><div class="line">#### 2.c Normalization</div>
<div class="line">One can choose \f$\ell_1\f$,\f$\ell_2\f$ or \f$\ell_{\infty}\f$ normalization, indicating p as the second argument. </div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">#include &lt;cosan/preprocessing/normalizer.h&gt;</div>
<div class="line">Coasn::Normalizer NM(CRD,p)// p can be 1,2 and std::numeric_limits&lt;int&gt;::max(). The default is 2.</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line">and the output reads</div>
</div><!-- fragment --><hr  />
<p> Begin normalizing data using norm 2! End of normalizing data using norm 2 One may get norm of each row by GetSampleNorm().</p>
<hr  />
 <div class="fragment"><div class="line">#### 2.e Standardization</div>
<div class="line">This operation standardizes each column so that each column has mean 0 and variance 1.  </div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">#include &lt;cosan/preprocessing/standardScaler.h&gt;</div>
<div class="line">Cosan::StandardScaler(CRD);</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line">and the output reads</div>
</div><!-- fragment --><hr  />
<p> Begin standardizing data End of standardizing data. One may transform or reverse-transform by .<a class="el" href="_custom_transform_test_8cpp.html#ac4df9746e406d7f3f388f646a4b02528">transform()</a>,.InvTransform() function.</p>
<hr  />
 <div class="fragment"><div class="line">#### 2.f Categorical encoding</div>
<div class="line">For categorical data type, we encoding them into numeric type, which is especially useful for downstreaming supervised learning tasks.</div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">#include &lt;cosan/preprocessing/encoder.h&gt;</div>
<div class="line">Cosan::Encoder ED(CRD,true);//the second argument as a flag to indicate whether the newly-generated numeric matrix for categorical should be added back to the original numeric matrix X.    </div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line">and the output reads</div>
</div><!-- fragment --><hr  />
<p> Begin encoding categorical data ! Finish encoding categorical data! Get access to the newly-generated additional matrix via .GetCatMatrix()</p>
<hr  />
<p> Notice that CRD.X has been modified. The dimension of X is (98,14). 4 columns of one-hot encoding have been added. </p><div class="fragment"><div class="line">The code snipptes can be found in `./test/tutorial_codeexamples/datapreprocessing.cpp`.</div>
<div class="line"> </div>
<div class="line">### 3.Feature Engineering</div>
<div class="line">We continue to use the preprocessed dataset to conduct downstreaming tasks on features engineering. </div>
<div class="line">#### 3.a Feature scaling (MinMaxScalar)</div>
<div class="line">We transform the range of the data distribution to per-determined [lb,ub] region, i.e. each entry will be upperbounded by lb and lowerbounded by ub. The transformation is a linear transformation and is useful especially in computer vision community where data need to be scaled [0,255] to [0,1] or vice versa.    </div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">#include &lt;cosan/preprocessing/minmaxscaler.h&gt;</div>
<div class="line">NumericType lb=0,ub=1;    </div>
<div class="line">Cosan::MinmaxScaler MMS(CRD,lb,ub);//transform X to domain [lb,ub]. If not provided, default value lb =0,ub=1</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line">and the output reads</div>
</div><!-- fragment --><hr  />
<p> Begin transformation to X to [0,1]! End of transformation to X to [0,1]!</p>
<hr  />
 <div class="fragment"><div class="line">#### 3.b Polynomial features generation</div>
<div class="line">This is to generate new polynomial features such as \f$x_1^2,x_4^2\f$ where \f$x_i\f$ indicates column i of matrix X. Beside `CRD`, an input type of `std::vector&lt;std::pair&lt;gsl::index,NumericType&gt;&gt;` to indicate new polynomial features. For instance, if um = {{1,2},{2,3}}, it means that two columns are generated where the first column is \f$x_1^2\f$ and the second column is \f$x_2^3\f$.   </div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">#include &lt;cosan/preprocessing/polynomialfeatures.h&gt;</div>
<div class="line">std::vector&lt;std::pair&lt;gsl::index,NumericType&gt;&gt; um = {{0,1.2},{1,1.1}};</div>
<div class="line">Cosan::PolynomialFeatures PF(CRD,um,true);//um is a vector of pair where each entries indicates index and power to be generated. The third argument indicates whether the new features should be added to CRD.X. Default is false.</div>
<div class="line">std::pair&lt;gsl::index,gsl::index&gt; pair = {4,5};</div>
<div class="line">PF.SetInteractionFeatures(CRD,pair,true);//to generative interactive features from column 4 and 5.</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line">and the output reads</div>
</div><!-- fragment --><hr  />
<p> Begin to generating polynomial features!! Generating power 1.200000 of Column 0! Generating power 1.100000 of Column 1! Finish generating polynomial features! Use .GetPolynomialFeatures() to get access it.</p>
<hr  />
<p> Notice that CRD.X has been modified. The dimension of X is (98,16). 2 columns of polynomialfeatures have been added.</p>
<hr  />
<p> Begin generating interaction features between 4 and 5!! End of generating interaction features. Get access to it via .GetInteractionFeatures()</p>
<hr  />
<p> Notice that CRD.X has been modified. The dimension of X is (98,17). 1 columns of interaction features have been added. </p><div class="fragment"><div class="line">#### 3.c Principal component analysis</div>
<div class="line">PCA is defined as an orthogonal linear transformation that transforms the data to a new coordinate system such that the greatest variance by some scalar projection of the data comes to lie on the first coordinate (called the first principal component), the second greatest variance on the second coordinate, and so on. More details can be seen [here](https://en.wikipedia.org/wiki/Principal_component_analysis).</div>
<div class="line">One may need to choose target number of principal component \f$p\f$. The default value is the minimum value of 5 and number of columns for X. </div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">#include &lt;cosan/preprocessing/principalcomponentanalysis.h&gt;</div>
<div class="line">gsl::index ncomponent = 5;</div>
<div class="line">Cosan::PrincipalComponentAnalysis PCA(CRD,ncomponent);</div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line">and the output reads</div>
</div><!-- fragment --><hr  />
<p> Begin PCA on Input Data X. Select the first 5 principal components The first 0 principal components explains 37.456450% of the total variance. The first 1 principal components explains 53.101910% of the total variance. The first 2 principal components explains 66.014039% of the total variance. The first 3 principal components explains 74.282581% of the total variance. The first 4 principal components explains 80.106676% of the total variance. The first 5 principal components explains 83.567345% of the total variance. The first 6 principal components explains 86.706581% of the total variance. The first 7 principal components explains 89.770204% of the total variance. The first 8 principal components explains 92.511648% of the total variance. The first 9 principal components explains 94.948812% of the total variance. The first 10 principal components explains 97.204781% of the total variance. The first 11 principal components explains 99.128878% of the total variance. Finsh PCA on Input Data X. The first 5 principal components explains 83.567345% of the total variance. Uer .GetPC() function to get the principal components.</p>
<hr  />
 <div class="fragment"><div class="line">#### 3.d User-defined transformation</div>
<div class="line">We allow a user-defined features with input type `std::vector&lt;NumericType&gt;`. The operation will add one additional column to CRD.X.</div>
<div class="line">~~~~~~~~~~~~~~~{.cpp}</div>
<div class="line">#include &lt;cosan/preprocessing/customtransform.h&gt;</div>
<div class="line">Cosan::CustomTransform CT(CRD,newInputX);// newInputX is of tpye std::vector&lt;NumericType&gt; to be added to CRD.X. </div>
<div class="line">~~~~~~~~~~~~~~~</div>
<div class="line">and the output reads</div>
</div><!-- fragment --><hr  />
<p> Begin to generating customized features!! End of generating customized features. One may get access to the new features via .GetCustomFeatures()!</p>
<hr  />
<p> Notice that CRD.X has been modified. The dimension of X is (98,18). 1 columns of new features have been added. ``` </p>
<h3><a class="anchor" id="autotoc_md103"></a>
4. Model Fitting</h3>
<p>Four linear models are given here. They are </p><div class="fragment"><div class="line"><a class="code" href="class_cosan_1_1_cosan_linear_regression.html">Cosan::CosanLinearRegression</a></div>
<div class="line"><a class="code" href="class_cosan_1_1_cosan_ridge_regression.html">Cosan::CosanRidgeRegression</a></div>
<div class="line"><a class="code" href="class_cosan_1_1_cosan_principal_component_regression.html">Cosan::CosanPrincipalComponentRegression</a></div>
<div class="line"><a class="code" href="class_cosan_1_1_cosan_p_c_r_ridge.html">Cosan::CosanPCRRidge</a></div>
</div><!-- fragment --><p>To initialize model object, one can do </p><div class="fragment"><div class="line">model(); <span class="comment">// The default constructor where the model is without intercept. </span></div>
<div class="line">model(<span class="keywordtype">bool</span> bias);</div>
<div class="line">model(<a class="code" href="onehotencoding_test_8cpp.html#aa28a5c88ac75442a7ecebdd88be79a45">NumericType</a> param, <span class="keywordtype">bool</span> bias);<span class="comment">//for model with only one parameter. Ridge regression and PCR are the cases.</span></div>
<div class="line">model(std::vector&lt;NumericType&gt; params, <span class="keywordtype">bool</span> bias);<span class="comment">//for model with more than one parameter. Each parameter is the enry of params. PCR with L2 square norm is the case. </span></div>
</div><!-- fragment --><p>To initialize model object and run model fitting automatically, one can do </p><div class="fragment"><div class="line">model(CosanRawData&lt;NumericType&gt; RD,<a class="code" href="onehotencoding_test_8cpp.html#aa28a5c88ac75442a7ecebdd88be79a45">NumericType</a> param ,<span class="keywordtype">bool</span> bias = <span class="keyword">false</span>)</div>
<div class="line">model(CosanData&lt;<a class="code" href="onehotencoding_test_8cpp.html#aa28a5c88ac75442a7ecebdd88be79a45">NumericType</a>&gt; CD,<a class="code" href="onehotencoding_test_8cpp.html#aa28a5c88ac75442a7ecebdd88be79a45">NumericType</a> param ,<span class="keywordtype">bool</span> bias = false)</div>
<div class="line">model(<a class="code" href="namespace_cosan.html#abf4015ccbd9ddd1cf0fe7b80afec97f3">CosanMatrix</a>&lt;<a class="code" href="onehotencoding_test_8cpp.html#aa28a5c88ac75442a7ecebdd88be79a45">NumericType</a>&gt; X,<a class="code" href="namespace_cosan.html#abf4015ccbd9ddd1cf0fe7b80afec97f3">CosanMatrix</a>&lt;<a class="code" href="onehotencoding_test_8cpp.html#aa28a5c88ac75442a7ecebdd88be79a45">NumericType</a>&gt; Y,<a class="code" href="onehotencoding_test_8cpp.html#aa28a5c88ac75442a7ecebdd88be79a45">NumericType</a> param,<span class="keywordtype">bool</span> bias = false)</div>
</div><!-- fragment --><p>For model with more than 1 parameter, one should replace <code>NumericType param</code> by <code>std::vector&lt;NumericType&gt; params</code>.</p>
<p>To call fit model in specific and use fitted model for prediction, one can do </p><div class="fragment"><div class="line">model.fit(CosanMatrix&lt;NumericType&gt; X,CosanMatrix&lt;NumericType&gt; Y)</div>
<div class="line">model.predict(CosanMatrix&lt;NumericType&gt; X)</div>
</div><!-- fragment --><p>To set new params and get current params, one can do </p><div class="fragment"><div class="line">model.SetParams(<a class="code" href="onehotencoding_test_8cpp.html#aa28a5c88ac75442a7ecebdd88be79a45">NumericType</a> param); <span class="comment">//for model with more than 1 parameter, input should be std::vecotr&lt;NumericType&gt; params  </span></div>
<div class="line">model.GetParams();</div>
</div><!-- fragment --><p>To obtain the coefficient for the model ( \(\beta\)), one can use </p><div class="fragment"><div class="line">model.GetBeta();</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md104"></a>
4.a Ordinary least square (linear regression)</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_cosan_linear_regression_8h.html">cosan/model/CosanLinearRegression.h</a>&gt;</span></div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md105"></a>
4.b Ordinary least square with L2-squared norm penalty (ridge regression)</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_cosan_ridge_regression_8h.html">cosan/model/CosanRidgeRegression.h</a>&gt;</span></div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md106"></a>
4.c Principal component regression (PCR)</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_cosan_principal_component_regression_8h.html">cosan/model/CosanPrincipalComponentRegression.h</a>&gt;</span></div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md107"></a>
4.d Principal component regressionw with \f$\ell_2\f$-squared norm penalty ( ridge PCR)</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_cosan_p_c_r_ridge_8h.html">cosan/model/CosanPCRRidge.h</a>&gt;</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md108"></a>
5. Model Selection</h3>
<p>Model selection module includes two main parts: splitter method and search method. Three splitter methods are included as well as the corresponding parallel-computing version: kfold, random kfold and timeseries kfold. Two search methods: grid search and random grid search. </p><div class="fragment"><div class="line"><a class="code" href="class_cosan_1_1_k_fold.html">Cosan::KFold</a></div>
<div class="line"><a class="code" href="class_cosan_1_1_k_fold_parallel.html">Cosan::KFoldParallel</a></div>
<div class="line"><a class="code" href="class_cosan_1_1_random_k_fold.html">Cosan::RandomKFold</a></div>
<div class="line"><a class="code" href="class_cosan_1_1_random_k_fold_parallel.html">Cosan::RandomKFoldParallel</a></div>
<div class="line"><a class="code" href="class_cosan_1_1_time_series_split.html">Cosan::TimeSeriesSplit</a></div>
<div class="line"><a class="code" href="class_cosan_1_1_time_series_split_parallel.html">Cosan::TimeSeriesSplitParallel</a></div>
</div><!-- fragment --><p>To initialize splitter object, the following syntax can be used </p><div class="fragment"><div class="line">splitter(gsl::index kfoldnumber);</div>
<div class="line">splitter(gsl::index nrows, gsl::index kfoldnumber) </div>
</div><!-- fragment --><p>The above second constructor will generate a private member function split_batch which can be get accessed via GetSplit() fnuction. To call splitting function specifically, one should do </p><div class="fragment"><div class="line">splitter.SetSplit()</div>
</div><!-- fragment --><p>To call parallel version, one should call the corresponding class for parallel computing and the remainder is the same.</p>
<h4><a class="anchor" id="autotoc_md109"></a>
5.a k-fold cross-validation</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="kfold_8h.html">cosan/selection/kfold.h</a>&gt;</span></div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md110"></a>
5.b random k-fold cross-validation</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="randomkfold_8h.html">cosan/selection/randomkfold.h</a>&gt;</span></div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md111"></a>
5.c timeseries k-fold cross-validation</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="timeseriessplit_8h.html">cosan/selection/timeseriessplit.h</a>&gt;</span></div>
</div><!-- fragment --><p>One should initialize search method via </p><div class="fragment"><div class="line">Search(CosanData&lt;NumericType&gt; CRD, Model estimator,Metric &amp; metric,Splitter &amp; split, std::vector&lt;NumericType&gt; paramGrid)</div>
</div><!-- fragment --><p>where <code>Model</code> is an inherited class of <code>CosanModel</code> class, <code>Metric</code> is an inherited class of <code>CosanMetric</code> class (which will be discussed in the next section), Splitter is the aforementioned splitter class and <code>std::vector&lt;NumericType&gt; paramGrid</code> is the list of parameters to selected from.</p>
<p>For multi-parameters version of search method, one should replace by [SearchName]+'Multi'. For instance,for <code>GridSearch</code>, one should call <code>GridSearchMulti</code> instead and replace <code>std::vector&lt;NumericType&gt; paramGrid</code> by <code>std::vector&lt;std::vector&lt;NumericType&gt;&gt; paramGrid</code>. For parallel computing version, one should append 'Parallel' as well. Additional input argument <code>int nthreads</code> (with default <code>-1</code>) is added to set the number of threads to be used. <code>-1</code> means uses all available threads. For instance, for <code>GridSearch</code> in both multi-parameters and parallel computing version, one should use <code>GridSearchMultiParallel</code>. <br  />
 </p>
<h4><a class="anchor" id="autotoc_md112"></a>
5.d grid search</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="gridsearch_8h.html">cosan/selection/gridsearch.h</a>&gt;</span></div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md113"></a>
5.e random grid search</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="randomgridsearch_8h.html">cosan/selection/randomgridsearch.h</a>&gt;</span></div>
</div><!-- fragment --><p>The following snippet gives one concrete example for cross-validation process, </p><div class="fragment"><div class="line">constexpr gsl::index nrows = 10000;</div>
<div class="line">constexpr gsl::index ncols = 5;</div>
<div class="line"><a class="code" href="namespace_cosan.html#abf4015ccbd9ddd1cf0fe7b80afec97f3">Cosan::CosanMatrix&lt;NumericType&gt;</a> X_input</div>
<div class="line"><a class="code" href="namespace_cosan.html#abf4015ccbd9ddd1cf0fe7b80afec97f3">Cosan::CosanMatrix&lt;NumericType&gt;</a> Y_input;    </div>
<div class="line">X_input.resize(nrows,ncols);</div>
<div class="line">Y_input.resize(nrows,1);</div>
<div class="line">X_input = Eigen::Matrix&lt;decltype(X_input)::Scalar,nrows,ncols&gt;::Random();</div>
<div class="line">Y_input = Eigen::Matrix&lt;decltype(X_input)::Scalar,nrows,1&gt;::Random();</div>
<div class="line"><a class="code" href="class_cosan_1_1_cosan_data.html">Cosan::CosanData&lt;NumericType&gt;</a>  CD(X_input,Y_input);</div>
<div class="line"><a class="code" href="class_cosan_1_1_cosan_p_c_r_ridge.html">Cosan::CosanPCRRidge</a>&lt;decltype(X_input)::Scalar&gt; CRRwbias;</div>
<div class="line"><a class="code" href="class_cosan_1_1_mean_square_error.html">Cosan::MeanSquareError</a>&lt;decltype(X_input)::Scalar&gt; mse;</div>
<div class="line"><a class="code" href="onehotencoding_test_8cpp.html#aa28a5c88ac75442a7ecebdd88be79a45">NumericType</a> a = 0.05;</div>
<div class="line">std::vector&lt;NumericType&gt; v(10);</div>
<div class="line">std::generate(v.begin(), v.end(), [n = 1, &amp;a]() <span class="keyword">mutable</span> { return n++ * a; });</div>
<div class="line"><a class="code" href="class_cosan_1_1_k_fold.html">Cosan::KFold</a> kf(5);</div>
<div class="line"><a class="code" href="class_cosan_1_1_random_grid_search.html">Cosan::RandomGridSearch</a> GDS(CD,CRRwbias,mse,kf,v);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md114"></a>
6. Evaluation</h3>
<h4><a class="anchor" id="autotoc_md115"></a>
6.1 Metric Class</h4>
<p>Metric is critical for cross-validation as it provides a venue to evaluate the performance of model and the best parameters to be chosen is based on the metric values. Four metrics are implemented in our library <code>maximum error</code>, <code>mean absolute error</code>,<code>mean square error</code>, <code>coefficient of determination</code>. The class names are</p>
<div class="fragment"><div class="line"><a class="code" href="class_cosan_1_1_mean_abs_error.html">Cosan::MeanAbsError</a></div>
<div class="line"><a class="code" href="class_cosan_1_1_mean_square_error.html">Cosan::MeanSquareError</a></div>
<div class="line"><a class="code" href="class_cosan_1_1_r2_score.html">Cosan::R2Score</a></div>
<div class="line"><a class="code" href="class_cosan_1_1_max_error.html">Cosan::MaxError</a></div>
</div><!-- fragment --><p>To call each individual metric class and calculate the corresponding metric one can do Initialize metric object </p><div class="fragment"><div class="line">Metric();</div>
<div class="line">Metric(CosanMatrix&lt;NumericType&gt; yPredict,CosanMatrix&lt;NumericType&gt; yTrue);<span class="comment">//will calculate error metric and store as a public member variable error. </span></div>
</div><!-- fragment --><p>To Calculate the error specifically, one should call </p><div class="fragment"><div class="line">model.GetError(CosanMatrix&lt;NumericType&gt;yPredict,CosanMatrix&lt;NumericType&gt; yTrue);</div>
</div><!-- fragment --><p>All metric class is stored at <code>./cosan/evaluation/CosanMetric.h</code>. <code>#include &lt;<a class="el" href="_cosan_metric_8h.html">cosan/evaluation/CosanMetric.h</a>&gt;</code> should suffice to call metric class.</p>
<p><b>Note</b>: the order of input argument <code>yPredict</code> and <code>yTrue</code> matters for <code><a class="el" href="class_cosan_1_1_r2_score.html" title="R2 square.">Cosan::R2Score</a></code></p>
<h4><a class="anchor" id="autotoc_md116"></a>
6.2 Basic statistics functions</h4>
<p>Those functions are defined in <code>./cosan/evaluation/statistics.h</code>. One can use the following snippet to calculate basic summary statistics. The calculation will also store the corresponding value in the public member variables <code>SampleCovariance</code>, <code>mean</code>,<code>variance</code>,<code>median</code>,<code>maxNum</code>,<code>minNum</code>. </p><div class="fragment"><div class="line"><a class="code" href="class_cosan_1_1_summary_statistics.html">Cosan::SummaryStatistics</a>().<a class="code" href="class_cosan_1_1_summary_statistics.html#ab12f772452bfd03faed5b910e8410322">GetSampleCovariance</a>(CosanMatrix&lt;NumericType&gt; X);</div>
<div class="line"><a class="code" href="class_cosan_1_1_summary_statistics.html">Cosan::SummaryStatistics</a>().<a class="code" href="class_cosan_1_1_summary_statistics.html#a25e42f7d21f6032264c4910ce2a4d971">GetMean</a>(CosanMatrix&lt;NumericType&gt; X);</div>
<div class="line"><a class="code" href="class_cosan_1_1_summary_statistics.html">Cosan::SummaryStatistics</a>().<a class="code" href="class_cosan_1_1_summary_statistics.html#ad3235643ff6e37ac07334ce30ca3fad2">GetVar</a>(CosanMatrix&lt;NumericType&gt; X);</div>
<div class="line"><a class="code" href="class_cosan_1_1_summary_statistics.html">Cosan::SummaryStatistics</a>().<a class="code" href="class_cosan_1_1_summary_statistics.html#a95dc68bb4b2e6a3ae27d3dcf67437fde">GetMedian</a>(CosanMatrix&lt;NumericType&gt; X);</div>
<div class="line"><a class="code" href="class_cosan_1_1_summary_statistics.html">Cosan::SummaryStatistics</a>().<a class="code" href="class_cosan_1_1_summary_statistics.html#a7b1b48128e0986221d0c7a86403363ea">GetMax</a>(CosanMatrix&lt;NumericType&gt; X);</div>
<div class="line"><a class="code" href="class_cosan_1_1_summary_statistics.html">Cosan::SummaryStatistics</a>().<a class="code" href="class_cosan_1_1_summary_statistics.html#afdb4a770a4b0e5a92594ecca02cd35b5">GetMin</a>(CosanMatrix&lt;NumericType&gt; X);</div>
</div><!-- fragment --><ol type="1">
<li>Useful matrix manipulation snippets</li>
</ol>
<p>Some useful matrix operation on <code>ConsanMatrix</code></p>
<p>Generate all zero matrix of size <code>n</code> by <code>m</code> </p><div class="fragment"><div class="line"><a class="code" href="namespace_cosan.html#abf4015ccbd9ddd1cf0fe7b80afec97f3">Cosan::CosanMatrix&lt;NumericType&gt;::Zero</a>(n,m);</div>
</div><!-- fragment --><p>Generate an identity matrix of size <code>n</code> </p><div class="fragment"><div class="line"><a class="code" href="namespace_cosan.html#abf4015ccbd9ddd1cf0fe7b80afec97f3">Cosan::CosanMatrix&lt;NumericType&gt;::Identity</a>(n,n);</div>
</div><!-- fragment --><p>Generate all one matrix of size <code>n</code> by <code>m</code> </p><div class="fragment"><div class="line">CosanMatrix&lt;NumericType&gt;::Ones(n,m);</div>
</div><!-- fragment --><p>File <code><a class="el" href="utils_2utils_8h.html">cosan/utils/utils.h</a></code> contains useful functions including <code>removeRow</code> and <code>removeColumn</code>. To remove \(k\)th row from <code>CosanMatrix</code> X or to remove the \(k\)th column, one can do </p><div class="fragment"><div class="line"><a class="code" href="utils_2utils_8h.html#ab3d2a356a462e00a7ab584b8833dba24">removeRow</a>(X,k);</div>
<div class="line"><a class="code" href="utils_2utils_8h.html#aae675471018eaa7498b5f325358c08d9">removeColumn</a>(X,k);</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="atimeseriessplit_8h_html"><div class="ttname"><a href="timeseriessplit_8h.html">timeseriessplit.h</a></div></div>
<div class="ttc" id="autils_2utils_8h_html_ab3d2a356a462e00a7ab584b8833dba24"><div class="ttname"><a href="utils_2utils_8h.html#ab3d2a356a462e00a7ab584b8833dba24">removeRow</a></div><div class="ttdeci">void removeRow(Matrix &amp;matrix, gsl::index rowToRemove)</div><div class="ttdef"><b>Definition:</b> <a href="utils_2utils_8h_source.html#l00011">utils.h:11</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_summary_statistics_html_a25e42f7d21f6032264c4910ce2a4d971"><div class="ttname"><a href="class_cosan_1_1_summary_statistics.html#a25e42f7d21f6032264c4910ce2a4d971">Cosan::SummaryStatistics::GetMean</a></div><div class="ttdeci">NumericType GetMean(const CosanMatrix&lt; NumericType &gt; &amp;X)</div><div class="ttdef"><b>Definition:</b> <a href="statistics_8h_source.html#l00032">statistics.h:32</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_random_grid_search_html"><div class="ttname"><a href="class_cosan_1_1_random_grid_search.html">Cosan::RandomGridSearch</a></div><div class="ttdef"><b>Definition:</b> <a href="randomgridsearch_8h_source.html#l00016">randomgridsearch.h:16</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_cosan_ridge_regression_html"><div class="ttname"><a href="class_cosan_1_1_cosan_ridge_regression.html">Cosan::CosanRidgeRegression</a></div><div class="ttdef"><b>Definition:</b> <a href="_cosan_ridge_regression_8h_source.html#l00018">CosanRidgeRegression.h:18</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_summary_statistics_html_ad3235643ff6e37ac07334ce30ca3fad2"><div class="ttname"><a href="class_cosan_1_1_summary_statistics.html#ad3235643ff6e37ac07334ce30ca3fad2">Cosan::SummaryStatistics::GetVar</a></div><div class="ttdeci">NumericType GetVar(const CosanMatrix&lt; NumericType &gt; &amp;X)</div><div class="ttdef"><b>Definition:</b> <a href="statistics_8h_source.html#l00039">statistics.h:39</a></div></div>
<div class="ttc" id="aonehotencoding_test_8cpp_html_aa28a5c88ac75442a7ecebdd88be79a45"><div class="ttname"><a href="onehotencoding_test_8cpp.html#aa28a5c88ac75442a7ecebdd88be79a45">NumericType</a></div><div class="ttdeci">double NumericType</div><div class="ttdef"><b>Definition:</b> <a href="onehotencoding_test_8cpp_source.html#l00020">onehotencodingTest.cpp:20</a></div></div>
<div class="ttc" id="a_cosan_ridge_regression_8h_html"><div class="ttname"><a href="_cosan_ridge_regression_8h.html">CosanRidgeRegression.h</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_random_k_fold_html"><div class="ttname"><a href="class_cosan_1_1_random_k_fold.html">Cosan::RandomKFold</a></div><div class="ttdef"><b>Definition:</b> <a href="randomkfold_8h_source.html#l00011">randomkfold.h:11</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_random_k_fold_parallel_html"><div class="ttname"><a href="class_cosan_1_1_random_k_fold_parallel.html">Cosan::RandomKFoldParallel</a></div><div class="ttdef"><b>Definition:</b> <a href="randomkfold_8h_source.html#l00043">randomkfold.h:43</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_summary_statistics_html_afdb4a770a4b0e5a92594ecca02cd35b5"><div class="ttname"><a href="class_cosan_1_1_summary_statistics.html#afdb4a770a4b0e5a92594ecca02cd35b5">Cosan::SummaryStatistics::GetMin</a></div><div class="ttdeci">NumericType GetMin(const CosanMatrix&lt; NumericType &gt; &amp;X)</div><div class="ttdef"><b>Definition:</b> <a href="statistics_8h_source.html#l00071">statistics.h:71</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_mean_square_error_html"><div class="ttname"><a href="class_cosan_1_1_mean_square_error.html">Cosan::MeanSquareError</a></div><div class="ttdoc">Mean squared error.</div><div class="ttdef"><b>Definition:</b> <a href="_cosan_metric_8h_source.html#l00132">CosanMetric.h:132</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_k_fold_parallel_html"><div class="ttname"><a href="class_cosan_1_1_k_fold_parallel.html">Cosan::KFoldParallel</a></div><div class="ttdef"><b>Definition:</b> <a href="kfold_8h_source.html#l00143">kfold.h:143</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_cosan_principal_component_regression_html"><div class="ttname"><a href="class_cosan_1_1_cosan_principal_component_regression.html">Cosan::CosanPrincipalComponentRegression</a></div><div class="ttdef"><b>Definition:</b> <a href="_cosan_principal_component_regression_8h_source.html#l00020">CosanPrincipalComponentRegression.h:20</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_k_fold_html"><div class="ttname"><a href="class_cosan_1_1_k_fold.html">Cosan::KFold</a></div><div class="ttdef"><b>Definition:</b> <a href="kfold_8h_source.html#l00012">kfold.h:12</a></div></div>
<div class="ttc" id="agridsearch_8h_html"><div class="ttname"><a href="gridsearch_8h.html">gridsearch.h</a></div></div>
<div class="ttc" id="arandomkfold_8h_html"><div class="ttname"><a href="randomkfold_8h.html">randomkfold.h</a></div></div>
<div class="ttc" id="anamespace_cosan_html_abf4015ccbd9ddd1cf0fe7b80afec97f3"><div class="ttname"><a href="namespace_cosan.html#abf4015ccbd9ddd1cf0fe7b80afec97f3">Cosan::CosanMatrix</a></div><div class="ttdeci">Eigen::Matrix&lt; NumericType, Eigen::Dynamic, Eigen::Dynamic &gt; CosanMatrix</div><div class="ttdef"><b>Definition:</b> <a href="_cosan_b_o_8h_source.html#l00037">CosanBO.h:37</a></div></div>
<div class="ttc" id="arandomgridsearch_8h_html"><div class="ttname"><a href="randomgridsearch_8h.html">randomgridsearch.h</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_cosan_data_html"><div class="ttname"><a href="class_cosan_1_1_cosan_data.html">Cosan::CosanData</a></div><div class="ttdoc">Data container.</div><div class="ttdef"><b>Definition:</b> <a href="_cosan_data_8h_source.html#l00546">CosanData.h:546</a></div></div>
<div class="ttc" id="a_cosan_p_c_r_ridge_8h_html"><div class="ttname"><a href="_cosan_p_c_r_ridge_8h.html">CosanPCRRidge.h</a></div></div>
<div class="ttc" id="a_cosan_linear_regression_8h_html"><div class="ttname"><a href="_cosan_linear_regression_8h.html">CosanLinearRegression.h</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_r2_score_html"><div class="ttname"><a href="class_cosan_1_1_r2_score.html">Cosan::R2Score</a></div><div class="ttdoc">R2 square.</div><div class="ttdef"><b>Definition:</b> <a href="_cosan_metric_8h_source.html#l00152">CosanMetric.h:152</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_summary_statistics_html_a95dc68bb4b2e6a3ae27d3dcf67437fde"><div class="ttname"><a href="class_cosan_1_1_summary_statistics.html#a95dc68bb4b2e6a3ae27d3dcf67437fde">Cosan::SummaryStatistics::GetMedian</a></div><div class="ttdeci">NumericType GetMedian(const CosanMatrix&lt; NumericType &gt; &amp;X)</div><div class="ttdef"><b>Definition:</b> <a href="statistics_8h_source.html#l00047">statistics.h:47</a></div></div>
<div class="ttc" id="a_cosan_principal_component_regression_8h_html"><div class="ttname"><a href="_cosan_principal_component_regression_8h.html">CosanPrincipalComponentRegression.h</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_summary_statistics_html"><div class="ttname"><a href="class_cosan_1_1_summary_statistics.html">Cosan::SummaryStatistics</a></div><div class="ttdoc">Class for statistics results.</div><div class="ttdef"><b>Definition:</b> <a href="statistics_8h_source.html#l00021">statistics.h:21</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_time_series_split_parallel_html"><div class="ttname"><a href="class_cosan_1_1_time_series_split_parallel.html">Cosan::TimeSeriesSplitParallel</a></div><div class="ttdef"><b>Definition:</b> <a href="timeseriessplit_8h_source.html#l00045">timeseriessplit.h:45</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_summary_statistics_html_a7b1b48128e0986221d0c7a86403363ea"><div class="ttname"><a href="class_cosan_1_1_summary_statistics.html#a7b1b48128e0986221d0c7a86403363ea">Cosan::SummaryStatistics::GetMax</a></div><div class="ttdeci">NumericType GetMax(const CosanMatrix&lt; NumericType &gt; &amp;X)</div><div class="ttdef"><b>Definition:</b> <a href="statistics_8h_source.html#l00064">statistics.h:64</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_cosan_p_c_r_ridge_html"><div class="ttname"><a href="class_cosan_1_1_cosan_p_c_r_ridge.html">Cosan::CosanPCRRidge</a></div><div class="ttdef"><b>Definition:</b> <a href="_cosan_p_c_r_ridge_8h_source.html#l00019">CosanPCRRidge.h:19</a></div></div>
<div class="ttc" id="autils_2utils_8h_html_aae675471018eaa7498b5f325358c08d9"><div class="ttname"><a href="utils_2utils_8h.html#aae675471018eaa7498b5f325358c08d9">removeColumn</a></div><div class="ttdeci">void removeColumn(Matrix &amp;matrix, gsl::index colToRemove)</div><div class="ttdef"><b>Definition:</b> <a href="utils_2utils_8h_source.html#l00022">utils.h:22</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_summary_statistics_html_ab12f772452bfd03faed5b910e8410322"><div class="ttname"><a href="class_cosan_1_1_summary_statistics.html#ab12f772452bfd03faed5b910e8410322">Cosan::SummaryStatistics::GetSampleCovariance</a></div><div class="ttdeci">CosanMatrix&lt; NumericType &gt; &amp; GetSampleCovariance(const CosanMatrix&lt; NumericType &gt; &amp;X)</div><div class="ttdef"><b>Definition:</b> <a href="statistics_8h_source.html#l00024">statistics.h:24</a></div></div>
<div class="ttc" id="akfold_8h_html"><div class="ttname"><a href="kfold_8h.html">kfold.h</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_mean_abs_error_html"><div class="ttname"><a href="class_cosan_1_1_mean_abs_error.html">Cosan::MeanAbsError</a></div><div class="ttdoc">Mean absolute error.</div><div class="ttdef"><b>Definition:</b> <a href="_cosan_metric_8h_source.html#l00112">CosanMetric.h:112</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_cosan_linear_regression_html"><div class="ttname"><a href="class_cosan_1_1_cosan_linear_regression.html">Cosan::CosanLinearRegression</a></div><div class="ttdef"><b>Definition:</b> <a href="_cosan_linear_regression_8h_source.html#l00020">CosanLinearRegression.h:20</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_max_error_html"><div class="ttname"><a href="class_cosan_1_1_max_error.html">Cosan::MaxError</a></div><div class="ttdoc">maximum error</div><div class="ttdef"><b>Definition:</b> <a href="_cosan_metric_8h_source.html#l00171">CosanMetric.h:171</a></div></div>
<div class="ttc" id="aclass_cosan_1_1_time_series_split_html"><div class="ttname"><a href="class_cosan_1_1_time_series_split.html">Cosan::TimeSeriesSplit</a></div><div class="ttdef"><b>Definition:</b> <a href="timeseriessplit_8h_source.html#l00010">timeseriessplit.h:10</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
